In Sentinel, go to Analytics > + Create > Scheduled Query Rule

Paste the KQL Query

Set frequency: Every 1 hour

Set threshold: Trigger when result count > 0

Map IP and Account fields for Entity Mapping

Add tactics: CredentialAccess, InitialAccess


{
  "displayName": "Suspicious WordPress Admin Login Without MFA (CVE-2024-7821)",
  "description": "Detects successful wp-login.php admin logins without a matching MFA verification call â€” possible MFA bypass exploit (CVE-2024-7821).",
  "severity": "High",
  "enabled": true,
  "query": "let loginEvents = Syslog\n| where ProcessName has \"wp-login.php\"\n| where LogonType == \"Success\"\n| where User contains \"admin\";\nlet mfaEvents = Syslog\n| where ProcessName has \"mfa/verify\";\nloginEvents\n| join kind=anti mfaEvents on $left.IPAddress == $right.IPAddress\n| project TimeGenerated, IPAddress, User, ProcessName",
  "queryFrequency": "1h",
  "queryPeriod": "1h",
  "triggerOperator": "GreaterThan",
  "triggerThreshold": 0,
  "suppressionDuration": "1h",
  "tactics": [
    "CredentialAccess",
    "InitialAccess"
  ],
  "techniques": [
    "T1078"
  ],
  "alertRuleTemplateName": "CVE20247821WordPressMFABypass",
  "customDetails": {
    "DetectedIP": "IPAddress",
    "TargetUser": "User"
  },
  "entityMappings": [
    {
      "entityType": "Account",
      "fieldMappings": [
        {
          "identifier": "Name",
          "columnName": "User"
        }
      ]
    },
    {
      "entityType": "IP",
      "fieldMappings": [
        {
          "identifier": "Address",
          "columnName": "IPAddress"
        }
      ]
    }
  ],
  "version": "1.0.0"
}
